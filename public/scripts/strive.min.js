((function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V=Object.prototype.hasOwnProperty,W=function(a,b){function d(){this.constructor=a}for(var c in b)V.call(b,c)&&(a[c]=b[c]);return d.prototype=b.prototype,a.prototype=new d,a.__super__=b.prototype,a},X=Array.prototype.indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};G=/((http\:\/\/|https\:\/\/|ftp\:\/\/)|(www\.))+(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi,h=/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/gi,Q=ko.utils.unwrapObservable,RegExp.escape=function(a){return a.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&")},Date.prototype.tomorrow=function(){return(new Date(this.getTime())).add(1).days()},Date.prototype.yesterday=function(){return(new Date(this.getTime())).add(-1).days()},_.mixin({trim:function(a){return a==null?"":a.toString().replace(/^\s+/,"").replace(/\s+$/,"")},linkify:function(a,b){return _.isObject(b)||(b={}),a=a.replace(G,function(a){var c;return c=_.trim(a),c=c.replace(/^(http|https|ftp):\/\//,""),b=_.attributize(b),'<a href="'+a+'" '+b+">"+c+"</a>"}),a},attributize:function(a){var b,c,d,e;return b="",_.isObject(a)||(d={}),b=function(){var b;b=[];for(c in a)e=a[c],e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;"),b.push(""+c+'="'+e+'"');return b}().join(" "),_.trim(b)},curry:function(a,b,c){return c=c||a,_.isArray(b)||(b=[b]),_.isFunction(a)||(a=function(){}),function(){return a.apply(c,_.zip(b,arguments))}},parseQueryString:function(a){var b;return b={},a=a||"",_.isString(a)||(a=a.toString()),$.each(a.split("&"),function(a,c){return c=c.split("=",2),b[c[0]]=c[1]||""}),b}}),P=(new Date).getTimezoneOffset(),this.Helpers={escapeHTML:function(a){return _.isString(a)||(a=""),$("<div/>").text(a).html()},concat:function(){var a,b,c,d;b="";for(c=0,d=arguments.length;c<d;c++)a=arguments[c],b+=Q(a);return b},resizeMaps:function(){return $(".gmap").each(function(a,b){var c,d;c=$(b);if(d=c.data("gmap"))return google.maps.event.trigger(d,"resize")})},join:function(a,b,c){var d,e,f,g,h;Falcon.isCollection(a)&&(a=a.list),ko.isObservable(a)&&(a=a()),_.isArray(a)||(a=[]),_.isString(c)||(h=[c,b],b=h[0],c=h[1]),_.isString(b)||(b=""),_.isString(c)||(c=" "),d="",b=_.trim(b);for(f=0,g=a.length;f<g;f++)e=a[f],_.isEmpty(b)||(e=e[b]),e=Q(e),d+=""+e+c;return d.length>0&&(d=d.slice(0,d.lastIndexOf(c))),d},open:function(a){_.isString(a)||(a="");if(_.isEmpty(a))return;return window.open(a,"downloadWindow")},random:function(a,b){var c,d;return b<a&&(d=[a,b],b=d[0],a=d[1]),c=b-a+1,parseInt(Math.random()*c)+a},adjustForTimezone:function(a){return a=a.add(-P).minutes()},formatDate:function(a,b){return a=Q(a),_.isString(a)&&(a=Date.parse(a)),a=new Date(a.getTime()),a=Helpers.adjustForTimezone(a),a.toString(b)},shortDateTime:function(a){return Helpers.formatDate(a,"M/d/yy h:mm")},shortDate:function(a){return Helpers.formatDate(a,"M/d/yy")},shortTime:function(a){return Helpers.formatDate(a,"h:mm tt")},fullDate:function(a){return Helpers.formatDate(a,"dddd, MMMM dS, yyyy")},isEmail:function(a){return a=Q(a),_.isString(a)||(a=""),a=_.trim(a),(new RegExp(h)).test(a)}},_.extend(ko.bindingHandlers,{fadeIf:{init:function(a,b){var c,d,e,f,g;return e=Q(b()),_.isBoolean(e)&&(e={"if":e}),_.isObject(e)||(e={}),d=Q((f=e["if"])!=null?f:!1),c=Q((g=e.opacity)!=null?g:.25),_.isBoolean(d)||(d=!1),_.isNumber(c)||(c=.25),d?$(a).stop().css({opacity:c}):$(a).stop().css({opacity:1})},update:function(a,b){var c,d,e,f,g,h,i,j,k,l,m;return h=Q(b()),_.isBoolean(h)&&(h={"if":h}),_.isObject(h)||(h={}),g=Q((i=h["if"])!=null?i:!1),c=Q((j=h.duration)!=null?j:250),f=Q((k=h.opacity)!=null?k:.25),d=Q((l=h.onHidden)!=null?l:function(){}),e=Q((m=h.onVisible)!=null?m:function(){}),_.isBoolean(g)||(g=!1),_.isNumber(c)||(c=250),_.isNumber(f)||(f=.25),_.isFunction(d)||(d=function(){}),_.isFunction(e)||(e=function(){}),g?$(a).stop().animate({opacity:f},c,d):$(a).stop().animate({opacity:1},c,e)}},fadeVisible:{init:function(a,b){var c,d,e,f,g,h;c=$(a),f=Q(b()),_.isBoolean(f)&&(f={"if":f}),_.isObject(f)||(f={}),c.data("__fade_visible_original_display__",c.css("display")),e=(g=Q(f["if"]))!=null?g:!1,_.isBoolean(e)||(e=!1);if(!e){d=Q((h=f.opacity)!=null?h:0),_.isNumber(d)||(d=0),c.css({opacity:d});if(d===0)return c.css({display:"none"})}},update:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;return i=Q(b()),_.isBoolean(i)&&(i={"if":i}),_.isObject(i)||(i={}),h=(j=Q(i["if"]))!=null?j:!1,c=(k=Q(i.duration))!=null?k:150,f=(l=Q(i.opacity))!=null?l:0,d=(m=Q(i.onHidden))!=null?m:function(){},e=(n=Q(i.onVisible))!=null?n:function(){},_.isBoolean(h)||(h=!1),_.isNumber(c)||(c=150),_.isNumber(f)||(f=0),_.isFunction(d)||(d=function(){}),_.isFunction(e)||(e=function(){}),h?(g=$(a).data("__fade_visible_original_display__"),g==="none"&&(g=""),$(a).stop().css({display:g}).animate({opacity:1},c,e)):$(a).stop().animate({opacity:f},c,function(){return f===0&&$(this).css({display:"none"}),d.apply(null,arguments)})}},slideVisible:{init:function(a,b){var c,d,e;return d=Q(b()),_.isBoolean(d)&&(d={"if":d}),_.isObject(d)||(d={}),c=Q((e=d["if"])!=null?e:!1),c?$(a).slideDown(0):$(a).slideUp(0)},update:function(a,b){var c,d,e,f,g,h,i,j,k;return g=Q(b()),_.isBoolean(g)&&(g={"if":g}),_.isObject(g)||(g={}),f=Q((h=g["if"])!=null?h:!1),c=Q((i=g.duration)!=null?i:250),d=Q((j=g.onHidden)!=null?j:function(){}),e=Q((k=g.onVisible)!=null?k:function(){}),_.isBoolean(f)||(f=!1),_.isNumber(c)||(c=250),_.isFunction(d)||(d=function(){}),_.isFunction(e)||(e=function(){}),f?$(a).slideDown(c,e):$(a).slideUp(c,d)}},gmap:{init:function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;c=$(a),m=b(),_.isObject(m)||(m={}),m.lat==null&&(m.lat=0),m.lng==null&&(m.lng=0),e=Q((r=m.lat)!=null?r:0),f=Q((s=m.lng)!=null?s:0),q=Q((t=m.zoom)!=null?t:9),h=Q((u=m.mapType)!=null?u:google.maps.MapTypeId.ROADMAP),i=Q((v=m.mapTypeControl)!=null?v:!1),k=(w=Q(m.markers))!=null?w:{},_.isNumber(e)||(e=0),_.isNumber(f)||(f=0),_.isNumber(q)||(q=6),_.isString(h)||(h=google.maps.MapTypeId.ROADMAP),_.isBoolean(i)||(i=!1),_.isObject(k)||(k={}),k.collection==null&&(k.collection=[]),c.addClass("gmap");if(c.is("img"))return a=$(a),d=parseInt(a.height()),p=parseInt(a.width()),d<=0&&(d=125),p<=0&&(p=250),n="http://maps.googleapis.com/maps/api/staticmap?sensor=false",n+="&center="+e+","+f,n+="&maptype="+h,n+="&size="+p+"x"+d,n+="&zoom="+q,n+="&markers=color:blue|size:mid|"+e+","+f,a.attr({src:n});g=new google.maps.Map(a,{center:new google.maps.LatLng(e,f),zoom:q,mapTypeId:h,mapTypeControl:i}),c.data("gmap",g),j=new google.maps.Marker({autoPan:!0,draggable:!0,position:new google.maps.LatLng(e,f),map:g,icon:new google.maps.MarkerImage("http://www.google.com/intl/en_us/mapfiles/ms/micons/blue-dot.png")}),o=function(){var a;a=j.getPosition(),e=a.lat(),f=a.lng(),ko.isObservable(m.lat)&&m.lat(e);if(ko.isObservable(m.lng))return m.lng(f)},ko.computed(function(){var a,b;return e=(a=Q(m.lat))!=null?a:0,f=(b=Q(m.lng))!=null?b:0,g.panTo(new google.maps.LatLng(e,f)),j.setPosition(new google.maps.LatLng(e,f))}).extend({throttle:1}),Falcon.isCollection(k.collection)&&(l=[],ko.computed(function(){var a,b,c;for(b=0,c=l.length;b<c;b++)a=l[b],a.setMap(null);return l=[],k.collection.each(function(a){return e=Q(a.lat),f=Q(a.lng),l.push(new google.maps.Marker({autoPan:!0,draggable:!1,position:new google.maps.LatLng(e,f),color:"blue",size:"small",map:g}))})}).extend({throttle:1})),google.maps.event.addListener(g,"drag",o),google.maps.event.addListener(g,"zoom",o),google.maps.event.addListener(g,"mouseup",o),google.maps.event.addListener(j,"mouseup",o);if(m.update!=null&&_.isFunction(m.update))return google.maps.event.addListener(j,"mouseup",m.update)}},tooltip:{update:function(a,b){var c;return c=Q(b()),_.isString(c)&&(c={title:c}),_.isObject(c)||(c={}),$(a).tooltip(c)}},navigate:{update:function(a,b){var c,d,e,f,g,h,i,j,k,l;h=Q(b()),_.isString(h)&&(h={url:h}),_.isObject(h)||(h={}),g=Q((i=h.url)!=null?i:""),f=Q((j=h.params)!=null?j:{}),d=Q((k=h.event)!=null?k:""),c=Q((l=h.doUpdate)!=null?l:!1),_.isString(g)||(g=""),_.isObject(f)||(f={}),_.isString(d)||(d="click"),_.isBoolean(c)||(c=!1),d=_.isEmpty(d)?"click":d.toLowerCase();for(e in f)h=f[e],f[e]=Q(h);return $(a).on(d,function(){return _.isEmpty(g)?Finch.navigate(f,c):_.isEmpty(f)?Finch.navigate(g,c):Finch.navigate(g,f,c)})}},avatar:{update:function(a,b){var c,d,e,f,g,h,i,j,k,l,m;return l=Q(b()),g={},l!=null&&(f=Q(l.facebook_id),d=Q(l.email),h=Q(l.picture_url),f!=null&&/^[0-9]+$/gi.test(f.toString())&&(g.facebook_id=f),d!=null&&Helpers.isEmail(d)&&(g.email=d),h&&_.isSting(h)&&(g.picture_url=h)),j=(m=$(a).height())!=null?m:50,j>0||(j=50),g.picture_url!=null?k=g.picture_url:g.facebook_id!=null?k="http://graph.facebook.com/"+g.facebook_id+"/picture":g.email!=null?(d=g.email,c="mm",i="",_.isString(d)||(d="unknown@unknown.com"),_.isString(c)||(c="mm"),_.isString(i)||(i=""),e=hex_md5($.trim(d).toLowerCase()),k="http://www.gravatar.com/avatar/"+e+"?",_.isEmpty(c)||(k+="d="+c+"&"),_.isEmpty(i)||(k+="r="+i+"&"),j!=null&&(k+="s="+j+"&")):k="./images/default-avatar.png",$(a).attr({src:k})}},src:{update:function(a,b){var c,d;return c=$(a),d=Q(b()),_.isString(d)||(d=""),_.isEmpty(d)&&(d="./images/default-avatar.png"),c.attr({src:d})}},placeholder:{update:function(a,b){var c;c=Q(b()),_.isString(c)||(c=""),$(a).attr("placeholder",c).placeholder()}},autoresize:{init:function(a,b){var c,d,e,f,g,h,i;return h=Q(b()),_.isNumber(h)&&(h={maxHeight:h}),_.isObject(h)||(h={maxHeight:0}),c=$(a),e=c.is("textarea")?c:c.find("textarea").first(),d=$("<div/>"),e.css("overflow","hidden").after(d),g=Math.max(e.height(),e.outerHeight()),f=(i=parseInt(h.maxHeight))!=null?i:0,f<0&&(f=0),d.css({display:"none","background-color":"#000000","white-space":"pre-wrap","word-wrap":"break-word","font-size":e.css("font-size"),"font-family":e.css("font-family")}),e.keyup(function(a){var b,c;return c=e.val().replace(/\r?\n/g,"<br/>"),a.which===13&&(c+="<br/>"),d.html(c),b=Math.max(g,d.height()),f>0?(b=Math.min(f,b),b===f&&e.css("overflow","auto")):e.css("overflow","hidden"),e.height(b)})}},stopEvent:{init:function(a,b){var c,d;c=$(a),d=Q(b()),_.isString(d)||(d="");if(_.isEmpty(d))return;c.on(d,function(a){return a.stopPropagation()})}},submitOnEnter:{init:function(a,b,c){var d,e,f;return f=b(),d=$(a),e=c().value,d.keydown(function(a){if(!Q(f))return;if(a.keyCode===Falcon.Event.ENTER_KEY&&!a.shiftKey)return a.preventDefault(),ko.isWriteableObservable(e)&&e(d.val()),d.parents("form").first().submit()})}},chosen:{init:function(a){var b;((b=ko.bindingHandlers["options"]["init"])!=null?b:function(){}).apply(null,arguments),$(a).chosen()},update:function(a){var b;((b=ko.bindingHandlers["options"]["update"])!=null?b:function(){}).apply(null,arguments),$(a).trigger("liszt:updated")}},selectOnFocus:{init:function(a){return $(a).on("focus",function(){var a=this;return _.defer(function(){return a.select()})})}},keyupValue:{init:function(a,b){var c,d,e,f;c=$(a),f=b(),ko.isObservable(f)&&(f={observable:f});if(!_.isObject(f))return;e=f.observable,d=Q(f.delay);if(!ko.isWriteableObservable(e))return;return _.isNumber(d)||(d=100),d<0&&(d=0),d=Math.floor(d),d===0?c.keyup(function(){return e(c.val())}):c.keyup(function(){var a;return a=c.val(),_.delay(function(){var b;b=c.val();if(b===a)return e(c.val())},d)})},update:function(a,b){var c,d,e;c=$(a),d=c.val(),e=Q(b());if(d!==e)return $(a).val(e)}},areachart:{update:function(a,b){var c,d;if(typeof google=="undefined"||google===null)return;d=Q(b());if(d instanceof Falcon.Report)return c=new google.visualization.AreaChart(a),d.request(c);return}},linechart:{update:function(a,b){var c,d;if(typeof google=="undefined"||google===null)return;d=Q(b());if(d instanceof Falcon.Report)return c=new google.visualization.LineChart(a),d.request(c);return}},piechart:{update:function(a,b){var c,d;if(typeof google=="undefined"||google===null)return;d=Q(b());if(d instanceof Falcon.Report)return c=new google.visualization.PieChart(a),d.request(c);return}},datepicker:{init:function(a,b){var c,d;return c=$(a),d=b(),c.datepicker({numberOfMonths:2,onSelect:function(a){return d(a)}})}},daterangepicker:{init:function(a,b){var c,d,e;return c=$(a),d=Q(b()),_.isObject(d)||(d={}),_.isFunction(d.start)||(d.start=function(){}),_.isFunction(d.end)||(d.end=function(){}),e=function(){var a,b;return b=Q(d.start),a=Q(d.end),c.find(".date-picker-field").html(Globalize.format(b,"MMMM d, yyyy")+" - "+Globalize.format(a,"MMMM d, yyyy"))},c.daterangepicker({ranges:{Today:["today","today"],Yesterday:["yesterday","yesterday"],"Last 7 Days":[Date.today().add({days:-6}),"today"],"Last 30 Days":[Date.today().add({days:-29}),"today"],"This Month":[Date.today().moveToFirstDayOfMonth(),Date.today().moveToLastDayOfMonth()],"Last Month":[Date.today().moveToFirstDayOfMonth().add({months:-1}),Date.today().moveToFirstDayOfMonth().add({days:-1})]}},function(a,b){return d.start(a),d.end(b),e()}),e()}},timepicker:function(){var a,b;return b=[["03:00","3:00 AM"],["03:15","3:15 AM"],["03:30","3:30 AM"],["03:45","3:45 AM"],["04:00","4:00 AM"],["04:15","4:15 AM"],["04:30","4:30 AM"],["04:45","4:45 AM"],["05:00","5:00 AM"],["05:15","5:15 AM"],["05:30","5:30 AM"],["05:45","5:45 AM"],["06:00","6:00 AM"],["06:15","6:15 AM"],["06:30","6:30 AM"],["06:45","6:45 AM"],["07:00","7:00 AM"],["07:15","7:15 AM"],["07:30","7:30 AM"],["07:45","7:45 AM"],["08:00","8:00 AM"],["08:15","8:15 AM"],["08:30","8:30 AM"],["08:45","8:45 AM"],["09:00","9:00 AM"],["09:15","9:15 AM"],["09:30","9:30 AM"],["09:45","9:45 AM"],["10:00","10:00 AM"],["10:15","10:15 AM"],["10:30","10:30 AM"],["10:45","10:45 AM"],["11:00","11:00 AM"],["11:15","11:15 AM"],["11:30","11:30 AM"],["11:45","11:45 AM"],["12:00","12:00 PM"],["12:15","12:15 PM"],["12:30","12:30 PM"],["12:45","12:45 PM"],["13:00","1:00 PM"],["13:15","1:15 PM"],["13:30","1:30 PM"],["13:45","1:45 PM"],["14:00","2:00 PM"],["14:15","2:15 PM"],["14:30","2:30 PM"],["14:45","2:45 PM"],["15:00","3:00 PM"],["15:15","3:15 PM"],["15:30","3:30 PM"],["15:45","3:45 PM"],["16:00","4:00 PM"],["16:15","4:15 PM"],["16:30","4:30 PM"],["16:45","4:45 PM"],["17:00","5:00 PM"],["17:15","5:15 PM"],["17:30","5:30 PM"],["17:45","5:45 PM"],["18:00","6:00 PM"],["18:15","6:15 PM"],["18:30","6:30 PM"],["18:45","6:45 PM"],["19:00","7:00 PM"],["19:15","7:15 PM"],["19:30","7:30 PM"],["19:45","7:45 PM"],["20:00","8:00 PM"],["20:15","8:15 PM"],["20:30","8:30 PM"],["20:45","8:45 PM"],["21:00","9:00 PM"],["21:15","9:15 PM"],["21:30","9:30 PM"],["21:45","9:45 PM"],["22:00","10:00 PM"],["22:15","10:15 PM"],["22:30","10:30 PM"],["22:45","10:45 PM"],["23:00","11:00 PM"],["23:15","11:15 PM"],["23:30","11:30 PM"],["23:45","11:45 PM"],["00:00","12:00 AM"],["00:15","12:15 AM"],["00:30","12:30 AM"],["00:45","12:45 AM"],["01:00","1:00 AM"],["01:15","1:15 AM"],["01:30","1:30 AM"],["01:45","1:45 AM"],["02:00","2:00 AM"],["02:15","2:15 AM"],["02:30","2:30 AM"],["02:45","2:45 AM"]],a="16:00",{init:function(c,d){var e,f,g,h,i;e=$(c),e.empty();for(g=0,h=b.length;g<h;g++)i=b[g],e.append($("<option value='"+i[0]+"'>"+i[1]+"</option>"));e.val(a),f=d();if(ko.isWriteableObservable(f))return e.change(function(a){return f(e.val())})},update:function(a,b){var c,d;c=$(a),d=Q(b());if(_.isString(d))try{d=Date.parse(d)}catch(e){}if(d instanceof Date)return c.val(d.toString("HH:mm"));return}}}(),number:{update:function(a,b){var c;return c=Q(b()),c*=1,$(a).text(Globalize.format(c,"n0"))}},currency:{update:function(a,b){var c,d;return d=Q(b()),d*=1,c=d===Math.floor(d)?"c0":"c",$(a).text(Globalize.format(d,c))}}}),ko.extenders.date=function(a,b){return ko.computed({read:function(){var b;return b=a(),_.isDate(b)?b.toString("MM/dd/yyyy"):b},write:function(b){var c;return _.isDate(b)&&(c=b),_.isString(b)&&(c=Date.parse(b)),a(_.isDate(c)&&!_.isNaN(c.getTime())?c:null)}})},ko.extenders.phone=function(a,b){return ko.computed(function(){var b;return b=Q(a),_.isString(b)||(b=""),a(b.replace(/[^0-9]/gi,""))}),a.formatted=ko.computed({read:function(){var b,c,d,e;return e=a(),_.isString(e)?e.length===7?(b=e.slice(0,3),c=e.slice(3,6),""+c+"-"+d):e.length===10?(b=e.slice(0,3),c=e.slice(3,6),d=e.slice(6,10),"("+b+") "+c+"-"+d):e:""},write:function(b){return a(b)}}),a},ko.extenders.price=function(a,b){return a.formatted=ko.computed({read:function(){return Globalize.format(a(),"c")},write:function(b){return b+="",b=b.replace(/[^0-9\.\-]/gi,""),b=parseFloat(b),_.isNaN(b)&&(b=0),a(b)}}),a},ko.extenders.enumerable=function(a,b){var c;return _.isObject(b)||(b={}),c=ko.computed({read:function(){return a()},write:function(c){if(b[c]!=null)return a(c)}}),c.subscribe=function(b){return a.subscribe(b)},c["enum"]=function(){return b},c},ko.extenders.transactable=function(a,b){var c;return c=ko.observable(a()),a.has_changed=ko.computed(function(){return c()!==a()}),a.commit=function(){return c(a())},a.rollback=function(){return a(c())},a},ko.extenders.errorable=function(a,b){return a.error=ko.observable("").extend({throttle:1}),a.has_error=ko.computed(function(){return _.trim(a.error()).length>0}),a.clear_error=function(){return a.error("")},a},ko.extenders.resetAfter=function(a,b){var c;return c=ko.utils.unwrapObservable(a),a.subscribe(function(d){if(d===c)return;return setTimeout(function(){return a(c)},b)}),a},Falcon.baseApiUrl="/api",i=this.Enum={},this.Enum.PERMISSIONS={user:"user",admin:"admin"},this.Enum.MAIN_VIEWS={},Finch.route("/",{setup:function(a){var b=this;this.view=new w,d(this.view),O.on("login",function(){return Finch.reload("/stream")}),O.on("logout",function(){return Finch.call("/")}),Finch.observe("query",function(a){return b.view.search_query(a)});if(O.is_logged_in())return this.view.showContentView()},load:function(){return O.is_logged_in()?Finch.navigate("/stream"):this.view.showSplashView(new D)}}),Finch.route("[/]stream",{setup:function(){var a=this;if(!O.is_logged_in()){Finch.abort(),Finch.navigate("/");return}return this.view=new F,this.parent.view.showContentView(this.view),Finch.observe("query",function(b){var c;c=a.view.events.query();if(c!==b)return a.view.events.query(b),a.view._fetchEvents()})},load:function(){if(this.view instanceof F)return this.view.showNearbyEvents();return}}),Finch.route("[/stream]/registered",function(){if(this.parent.view instanceof F)return this.parent.view.showRegisteredEvents();return}),Finch.route("[/stream]/invited",function(){if(this.parent.view instanceof F)return this.parent.view.showInvitedEvents();return}),Finch.route("[/stream]/park",function(){if(this.parent.view instanceof F)return this.parent.view.showLeagueEvents();return}),Finch.route("[/]event/:event_id",{setup:function(a){var b;return b=a.event_id,this.view=new q(b)},load:function(a){var b;return b=a.event_id,this.parent.view.showContentView(this.view)}}),Finch.route("[/]relationships",{setup:function(){return this.view=new A,this.parent.view.showContentView(this.view)}}),Finch.route("[/]settings",{setup:function(){return this.view=new C,this.parent.view.showContentView(this.view)},load:function(){return this.view.showProfile()}}),Finch.route("[/settings]/password",function(){return this.parent.view.showPassword()}),Finch.route("[/settings]/credit_card",function(){return this.parent.view.showCreditCard()}),Finch.route("[/settings]/connect",function(){return this.parent.view.showConnect()}),Finch.route("[/settings]/picture",function(){return this.parent.view.showPicture()}),Finch.route("[/]statistics",{setup:function(){return this.view=new E,this.parent.view.showContentView(this.view)}}),Finch.route("[/]logout",{load:function(){return O.logout()}}),$(document).ajaxError(function(a,b){switch(b.status){case 401:return Finch.navigate("/logout"),a.stopPropogation()}}),x=function(a){function b(){var a,c,d,e=this;this.query=ko.observable(""),this.page_loading=ko.observable(!1),c=ko.observable(0),this.page_count=ko.computed({read:function(){var a;return a=c(),a=Math.max(0,c),a},write:function(a){return a=parseInt(a),a=Math.max(0,a),c(a)}}),a=ko.observable(1),this.page=ko.computed({read:function(){var b;return b=a(),b=Math.max(1,b),b},write:function(b){return b=parseInt(b),b=Math.max(1,b),a(b)}}),d=ko.observable(20),this.page_size=ko.computed({read:function(){var a,b;return a=(b=d())!=null?b:1,a=Math.max(1,a),a},write:function(a){var b;return a=(b=parseInt(a))!=null?b:1,a=Math.max(1,a),d(a)}}),b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.sync=function(a,c){var d,e,f,g=this;return c==null&&(c={}),c.params==null&&(c.params={}),(d=c.params)["q"]==null&&(d.q=this.query()),(e=c.params)["page"]==null&&(e.page=this.page()),(f=c.params)["per"]==null&&(f.per=this.page_size()),_.isEmpty(c.params.q)&&delete c.params.q,c.fill=!1,c.success=function(a,b){return a.fill(b.models)},b.__super__.sync.call(this,a,c)},b.prototype.next=function(a){return this.page(this.page()+1),this.sync("GET",a),this},b.prototype.previous=function(a){return this.page(this.page()-1),this.sync("GET",a),this},b}(Falcon.Collection),g=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="/activity",b.prototype.fields={mobile:"mobile",name:"name",original:"original",thumbnail:"thumbnail"},b}(Falcon.Model),B=function(a){function c(a){if(b instanceof c)return b;b=this,this.is_logged_in=ko.observable(!1),this.user=ko.observable(null),this.loaded=ko.observable(!1),this.errors={},this.username=ko.observable(null),this.password=ko.observable(null),this.facebook_access_token=ko.observable(null),c.__super__.constructor.call(this),_.isFunction(a)&&this.loaded.subscribe(function(b){return a()===b&&b===!0}),this.fetch()}var b;return W(c,a),b=null,c.prototype.url="/session",c.prototype.fields={username:"username",password:"password",facebook_access_token:"facebook_access_token"},c.prototype.loaded=!1,c.prototype.is_logged_in=!1,c.prototype.user=null,c.prototype.errors=null,c.prototype._createUser=function(a){var b;return b=new H,b.map({name:ko.observable(),can_pay:ko.observable()}),b.fill(a),this.user(b)},c.prototype.makeUrl=function(){return""+Falcon.baseApiUrl+this.url},c.prototype.save=function(){},c.prototype.create=function(){},c.prototype.destroy=function(){},c.prototype.fetch=function(){var a=this;return this.sync("GET",{complete:function(){return a.loaded(!0)},success:function(b,c){return a._createUser(c),a.is_logged_in(!0)},error:function(b,c){return a.errors=c,a.is_logged_in(!1),a.user(null),a.trigger("error")}}),this},c.prototype._attemptLogin=function(a,b){var c=this;return _.isObject(b)||(b={}),_.isFunction(b.success)||(b.success=function(){}),_.isFunction(b.error)||(b.error=function(){}),_.isFunction(b.complete)||(b.complete=function(){}),this.sync("POST",{fields:a,complete:function(){return c.loaded(!0),b.complete.apply(b,arguments)},success:function(a,d){return c._createUser(d),c.is_logged_in(!0),c.trigger("login"),b.success.apply(b,arguments)},error:function(a,d){return c.errors=d,c.is_logged_in(!1),c.trigger("error"),b.error.apply(b,arguments)}}),this},c.prototype.login=function(a,b,c){return this.clearFields(),a!=null&&(a=Q(a),_.isString(a)||(a=""),this.username(_.trim(a))),b!=null&&(b=Q(b),_.isString(b)||(b=""),this.password(_.trim(b))),this._attemptLogin(["username","password"],c),this},c.prototype.facebookLogin=function(a){var b=this;return _.isObject(a)||(a={}),_.isFunction(a.facebook_complete)||(a.facebook_complete=function(){}),_.isFunction(a.facebook_success)||(a.facebook_success=function(){}),_.isFunction(a.facebook_error)||(a.facebook_error=function(){}),this.clearFields(),L.facebookLogin(function(c){return c.authResponse!=null?(a.facebook_success.apply(a,arguments),b.facebook_access_token(c.authResponse.accessToken),b._attemptLogin(["facebook_access_token"],a)):a.facebook_error.apply(a,arguments),a.facebook_complete.apply(a,arguments)}),this},c.prototype.clearFields=function(){return this.username(null),this.password(null),this.facebook_access_token(null),this},c.prototype.logout=function(){var a=this;return this.sync("DELETE",{success:function(){return a.is_logged_in(!1),a.user(null),a.trigger("logout")}}),this},c}(Falcon.Model),H=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="user",b.prototype.fields={name:"name",email:"email",username:"username",gender:"gender",dob:"birthday",facebook_id:"facebook_id",picture_url:"picture_url",recieve_notifications:"recieve_notifications",lat:"lat",lng:"lng",location:"location",can_pay:"can_pay",is_parent:"is_parent",permissions:"permissions",stripe_token:"stripe_token",relations:"relations",event_instructor:"event_instructor",registrations:"registrations",children_registrations:"children_registrations",created_on:"created_on",updated_on:"updated_on"},b.prototype.initialize=function(){return this.relations=new z,this.registrations=new n,this.children_registrations=new n},b.prototype.is_admin=function(){var a;return a=this.get("permissions"),_.isString(a)?_.include(this.permissions.split(","),i.PERMISSIONS.admin):!1},b.prototype.first_name=function(){var a,b;return a=this.get("name"),_.isString(a)||(a=""),(b=a.split(" ",2)[0])!=null?b:""},b.prototype.all_registrations=function(){var a,b;return b=this.get("registrations").list(),a=this.get("children_registrations").list(),b.concat(a)},b}(Falcon.Model),j=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="event",b.prototype.fields={name:"name",description:"description",fee:"fee",start_age:"start_age",end_age:"end_age",adult_only:"adult_only",friend_count:"friend_count",friends:"friends",size:"size",min:"min",max:"max",lat:"lat",lng:"lng",images:"images",thumbnails:"thumbnails",facility:"facility",activity:"activity",sessions:"sessions",instructor:"instructor",registrations:"registrations",comments:"comments",created_on:"created_on",updated_on:"updated_on"},b.prototype.initialize=function(){return this.sessions=new p(this),this.registrations=new n(this),this.activity=new g,this.facility=new t,this.friends=new I,this.instructor=new H,this.comments=new l(this),this._start_date=null,this._end_date=null},b.prototype.display_name=function(){var a,b,c,d;return d=this.get("name"),a=this.get("activity"),b=a instanceof g?a.get("name"):"",_.isString(d)||(d=""),_.isString(b)||(b=""),c=_.isEmpty(d)?b:d,_.trim(c)},b.prototype.age_range=function(){var a,b,c,d,e;return b=this.get("start_age"),a=this.get("end_age"),b=(c=parseInt(b))!=null?c:-1,a=(d=parseInt(a))!=null?d:-1,a<b&&(e=[a,b],b=e[0],a=e[1]),b>-1&&a>-1?""+b+" - "+a:b>-1?""+b+"+":a>-1?"<"+a:""},b.prototype.friend_count_string=function(){var a;return a=Q(this.friend_count),_.isNumber(a)||(a=friends.length()),a!==1?""+a+" friends signed up":""+a+" friend signed up"},b}(Falcon.Model),k=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="comment",b.prototype.fields={event:"event",user:"user",content:"content",commented_at:"commented_at"},b.prototype.initialize=function(){return this.event=new j,this.user=new H},b}(Falcon.Model),o=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.fields={event:"event"},b.prototype.initialize=function(){return this.event=new j},b}(Falcon.Model),m=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="registration",b.prototype.fields={event:"event",user:"user"},b.prototype.initialize=function(){return this.user=new H,this.event=new j},b}(Falcon.Model),t=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="facility",b.prototype.fields={},b}(Falcon.Model),u=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="invitation",b.prototype.fields=["facebook_access_token","facebook_id","email","message"],b.prototype.sendFacebook=function(a,b,c){var d;d=Q(L.facebookAccessToken);if(d==null||_.isEmpty(d)){alert("You're not logged into facebook!");return}return this.set("facebook_access_token",d),this.set("message",b),this.set("facebook_id",a),_.isFunction(c)&&(c={complete:c}),_.isObject(c)||(c={}),c.fields={facebook_access_token:"facebook_access_token",message:"message",facebook_id:"facebook_id"},this.create(c)},b.prototype.sendEmail=function(a,b,c){return this.set("message",b),this.set("email",a),_.isFunction(c)&&(c={complete:c}),_.isObject(c)||(c={}),c.fields={message:"message",email:"email"},this.create(c)},b}(Falcon.Model),y=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="user/relation",b}(H),f=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.model=g,b}(Falcon.Collection),I=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.model=H,b}(Falcon.Collection),r=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.model=j,b}(x),l=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.model=k,b}(Falcon.Collection),p=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.model=o,b}(Falcon.Collection),n=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.model=m,b.prototype.createFromUserAndDonation=function(a,b,c){var d;a=Q(a);if(a instanceof H)return b=Q(b),_.isObject(c)||(c={}),_.isObject(d)||(c.data={}),d=_.extend(c.data,a.serialize(["id"])),d.donate=b,c.data=d,c.fields=["id","donate"],this.create(new m,c);return},b}(Falcon.Collection),s=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.model=t,b}(Falcon.Collection),z=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.model=y,b}(Falcon.Collection),w=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="/layout.tmpl",b.prototype.initialize=function(){return this.content_view=ko.observable(),this.splash_view=ko.observable(),this.overlay_view=ko.observable(),this.showing_content_view=ko.observable(!1),this.showing_splash_view=ko.observable(!1),this.showing_overlay_view=ko.observable(!1),this.showing_user_options=ko.observable(!1),this.showing_location_select=ko.observable(!1),this.overlay_closed=ko.observable(!0),this.search_query=ko.observable()},b.prototype.current_location=function(){var a,b;return a=Q(L.location.city),b=Q(L.location.state),_.isString(a)||(a=null),_.isString(b)||(b=null),a!=null&&b!=null?""+a+", "+b:a!=null?a:b!=null?b:""},b.prototype._resetViewFlags=function(){return this.showing_splash_view(!1),this.showing_content_view(!1),this.showing_overlay_view(!1)},b.prototype.showContentView=function(a){var b=this;if(a instanceof Falcon.View)return this._resetViewFlags(),this.showing_content_view(!0),this.content_view(a),a.on("showOverlay",function(a){return b.showOverlayView(a)});return},b.prototype.showSplashView=function(a){if(a instanceof Falcon.View)return this._resetViewFlags(),this.showing_splash_view(!0),this.splash_view(a);return},b.prototype.showOverlayView=function(a){var b=this;if(a instanceof Falcon.View)return this.showing_overlay_view(!0),this.overlay_closed(!1),this.overlay_view(a),a.on("close",function(){return b.hideOverlayView()});return},b.prototype.hideOverlayView=function(){return this.showing_overlay_view(!1),this.overlay_closed(!0)},b.prototype.toggleUserOptions=function(){return this.showing_user_options(!this.showing_user_options()),this.showing_location_select(!1)},b.prototype.toggleLocationSelect=function(){return this.showing_location_select(!this.showing_location_select()),this.showing_user_options(!1)},b.prototype.doSearch=function(){return Finch.navigate({query:this.search_query()})},b.prototype.back=function(){return window.history.back()},b}(Falcon.View),q=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="event.tmpl",b.prototype.initialize=function(a){var b=this;return this.event=new j({id:a}),this.event_loading=ko.observable(!1),this.showing_register=ko.observable(!1),this.registerable_users=ko.computed(function(){var a;return a=Q(N),a instanceof H?[a].concat(a.get("relations").list()):[]}),this.selected_registrants=ko.observableArray([]),this.registration_donate=ko.observable(!1),this.registraion_loading=ko.observable(!1),this.show_registration_success=ko.observable(!1).extend({resetAfter:5e3}),this.registration_fee=ko.computed(function(){var a,c;return a=(c=b.event.get("fee"))!=null?c:0,Q(b.registration_donate)===!0&&(a+=1),a=b.selected_registrants().length*a,a}),this.posting_message=ko.observable(!1),this.new_message=ko.observable(),this.event.map({activity:{original:ko.observable()}}),this._fetchEvent()},b.prototype._fetchEvent=function(){var a=this;return this.event_loading(!0),this.event.fetch({success:function(b,c){var d;return c!=null&&c.activity!=null&&c.activity.original!=null?(d=new Image,d.onload=function(){return a.event_loading(!1)},d.src=c.activity.original):a.event_loading(!1),console.log(a.event.serialize())},error:function(){return a.event_loading(!1)}})},b.prototype.filtered_comments=function(){var a;return a=this.event.comments},b.prototype.calculated_size=function(){var a;return a=this.event.get("registrations").length(),a*=1,_.isNaN(a)&&(a=0),a+this.selected_registrants().length},b.prototype.has_instructor=function(){return this.event.instructor.get("id")!==null},b.prototype.is_instructor=function(){var a,b;return b=Q(N),b instanceof H?(a=b.get("id"),a!=null&&a>0?this.event.instructor.get("id")===a:!1):!1},b.prototype.showRegister=function(){return this.showing_register(!0)},b.prototype.hideRegister=function(){return this.showing_register(!1)},b.prototype.registrationEnabled=function(){return this.selected_registrants().length>0},b.prototype.registrantIsSelected=function(a){var b;return b=this.selected_registrants.indexOf(a)>-1,b=b||this.userIsRegistered(a),b},b.prototype.toggleRegistrant=function(a){var b;return this.registrantIsSelected(a)?this.userIsRegistered(a)?alert("This user is already registered for this event"):this.selected_registrants.remove(a):(b=this.event.get("max"),b<=0||this.calculated_size()<b?this.selected_registrants.push(a):alert("Cannot allow more more people to join this event, it is full."))},b.prototype.registered_users=function(){var a,b,c,d,e,f,g=this;return f=Q(N),f instanceof H?(e=this.registerable_users(),b=this.event.get("id"),a=f.all_registrations(),d=function(){var a,b,d;d=[];for(a=0,b=e.length;a<b;a++)c=e[a],Falcon.isModel(c)&&d.push(c.get("id"));return d}(),_.filter(a,function(a){var c,e,f;return a instanceof m?(e=(f=a.get("user").get("id"),X.call(d,f)>=0),c=a.get("event").get("id")===b,e&&c):!1})):[]},b.prototype.userIsRegistered=function(a){var b,c,d,e,f=this;return a=Q(a),a instanceof H?(e=Q(N),e instanceof H?(d=a.get("id"),b=this.event.get("id"),c=e.all_registrations(),_.any(c,function(a){var c,e;return a instanceof m?(e=a.get("user").get("id")===d,c=a.get("event").get("id")===b,e&&c):!1})):!1):!1},b.prototype.register=function(){var a,b,c,d,e,f,g,h,i=this;if(!this.registrationEnabled())return;this.registraion_loading(!0),b=this.selected_registrants(),c=b.length,d=this.event.get("registrations"),e=function(){c--;if(c===0)return i.selected_registrants([]),i.show_registration_success(!0),i.registraion_loading(!1)},h=[];for(f=0,g=b.length;f<g;f++)a=b[f],h.push(d.createFromUserAndDonation(a,this.registration_donate,{complete:e,success:function(a){return N().get("registrations").push(a),this.event.get("registrations").push(a)}}));return h},b.prototype.showInvite=function(){return this.trigger("showOverlay",new v(this.event))},b.prototype.cancelNewMessage=function(){return this.new_message("")},b.prototype.postNewMessage=function(){var a,b,c=this;if(!this.is_instructor())return;a=_.trim((b=Q(this.new_message))!=null?b:"");if(_.isEmpty(a)){alert("Please enter a message");return}return this.posting_message(!0),this.event.comments.create({fields:["content"],content:a,complete:function(){return c.posting_message(!1)},success:function(){return c.new_message("")},error:function(){return alert("An error occurred while trying to post your message")}})},b}(Falcon.View),v=function(a){function c(){c.__super__.constructor.apply(this,arguments)}var b;return W(c,a),c.prototype.url="invite.tmpl",b=null,c.prototype.initialize=function(a){var c=this;return this.fb_friends=ko.observableArray(),this.fb_friends_count=ko.computed(function(){return c.fb_friends().length}),this.fb_friend_query=ko.observable(),this.loading_friends=ko.observable(!1),this.message=ko.observable(""),this.selected_friends=ko.observableArray(),this.event=a,b==null?(this.loading_friends(!0),FB.api("/me/friends",function(a){return b=a.data,c.fb_friends(b),c.loading_friends(!1)})):this.fb_friends(b)},c.prototype.filtered_fb_friends=function(){var a,b,c,d,e,f,g;b=this.fb_friends(),c=this.fb_friend_query(),c=_.trim((c!=null?c:"").toString()),c=c.replace(/\s\s+/," ").toLowerCase();if(!_.isEmpty(c)){e=c.split(" ");for(f=0,g=e.length;f<g;f++)d=e[f],b=function(){var c,e,f;f=[];for(c=0,e=b.length;c<e;c++)a=b[c],a.name.toLowerCase().indexOf(d)>-1&&f.push(a);return f}()}return b=b.sort(function(a,b){var c,d;return c=_.trim(a.name.toLowerCase()),d=_.trim(b.name.toLowerCase()),c>d?1:c<d?-1:0}),b.slice(0,31)},c.prototype.friendIsSelected=function(a){return this.selected_friends.indexOf(a)>-1},c.prototype.toggleFriend=function(a){return this.friendIsSelected(a)?this.selected_friends.remove(a):this.selected_friends.push(a)},c.prototype.send=function(){var a,b,c,d,e,f,g,h=this;b=this.selected_friends(),d=b.length,console.log(this.message()),g=[];for(e=0,f=b.length;e<f;e++)a=b[e],c=new u(this.event),g.push(c.sendFacebook(a.id,this.message(),function(){d--;if(d<=0)return h.trigger("close")}));return g},c}(Falcon.View),A=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="relationships.tmpl",b.prototype.initialize=function(){return this.relationships=N().relations,this.new_relationship_message=ko.observable().extend({errorable:!0}),this.new_relationship_fields={name:ko.observable().extend({errorable:!0}),email:ko.observable().extend({errorable:!0}),birthday:ko.observable().extend({errorable:!0}),username:ko.observable().extend({errorable:!0}),password:ko.observable().extend({errorable:!0}),retype:ko.observable().extend({errorable:!0})},this.showing_add_form=ko.observable(!1)},b.prototype.showAddForm=function(){return this.showing_add_form(!0)},b.prototype.hideAddForm=function(){return this.new_relationship_message.clear_error(),this.new_relationship_fields.name.clear_error(),this.new_relationship_fields.email.clear_error(),this.new_relationship_fields.birthday.clear_error(),this.new_relationship_fields.username.clear_error(),this.new_relationship_fields.password.clear_error(),this.new_relationship_fields.retype.clear_error(),this.new_relationship_fields.name(""),this.new_relationship_fields.email(""),this.new_relationship_fields.birthday(""),this.new_relationship_fields.username(""),this.new_relationship_fields.password(""),this.new_relationship_fields.retype(""),this.showing_add_form(!1)},b.prototype.addRelationship=function(){var a,b,c,d,e,f,g,h=this;this.new_relationship_message.clear_error(),this.new_relationship_fields.name.clear_error(),this.new_relationship_fields.email.clear_error(),this.new_relationship_fields.birthday.clear_error(),this.new_relationship_fields.username.clear_error(),this.new_relationship_fields.password.clear_error(),this.new_relationship_fields.retype.clear_error(),d=Q(this.new_relationship_fields.name),b=Q(this.new_relationship_fields.email),a=Q(this.new_relationship_fields.birthday),g=Q(this.new_relationship_fields.username),e=Q(this.new_relationship_fields.password),f=Q(this.new_relationship_fields.retype),c=!1,_.isString(d)||(this.new_relationship_fields.name.error("Name must be a string value"),c=!0),_.isString(b)||(this.new_relationship_fields.email.error("Email address must be a string value"),c=!0),_.isString(a)||(this.new_relationship_fields.birthday.error("Birthday address must be a string value"),c=!0),_.isString(g)||(this.new_relationship_fields.username.error("Username must be a string value"),c=!0),_.isString(e)||(this.new_relationship_fields.password.error("Password must be a string value"),c=!0),_.isString(f)||(this.new_relationship_fields.retype.error("Password retype must be a string value"),c=!0);if(c)return;d=_.trim(d),b=_.trim(b),a=_.trim(a),g=_.trim(g),e=_.trim(e),f=_.trim(f),_.isEmpty(d)&&(this.new_relationship_fields.name.error("Please enter a name"),c=!0),_.isEmpty(a)&&(this.new_relationship_fields.birthday.error("Please enter a birthday"),c=!0),_.isEmpty(g)&&(this.new_relationship_fields.name.error("Please enter a username"),c=!0),_.isEmpty(e)&&(this.new_relationship_fields.name.error("Please enter a password"),c=!0),_.isEmpty(f)&&(this.new_relationship_fields.retype.error("Please enter a password retype"),c=!0);if(c)return;try{a=Date.parse(a)}catch(i){relationship.birthday.error("Please enter a valid birthday"),c=!0}if(c)return;e!==f&&(this.new_relationship_message.error("Passwords do not match"),c=!0);if(c)return;!_.isEmpty(b)&&!Helpers.isEmail(b)&&(relationship.password.error("Please enter a valid email address"),c=!0);if(c)return;return this.relationships.create({name:d,username:g,email:b,password:e,year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate()},{fields:["name","username","email","password","year","month","day"],error:function(){return h.new_relationship_message.error("An error occurred")},success:function(){return console.log("Successfully added relationship"),h.hideAddForm()}})},b.prototype.deleteRelationship=function(a){if(a instanceof y)return this.relationships.destroy(a);return},b}(Falcon.View),C=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="settings.tmpl",b.prototype.initialize=function(){var a=this;return this.showing_profile=ko.observable(!1),this.showing_credit_card=ko.observable(!1),this.showing_password=ko.observable(!1),this.showing_picture=ko.observable(!1),this.showing_connect=ko.observable(!1),this.saving_settings=ko.observable(!1),this.profile_fields={show_success:ko.observable(!1).extend({resetAfter:5e3}),name:ko.observable().classify("errorable"),email:ko.observable().classify("errorable"),birthday:ko.observable().classify("date","errorable")},ko.computed(function(){var b;b=Q(N);if(b==null)return;return a.profile_fields.name(b.get("name")),a.profile_fields.email(b.get("email")),a.profile_fields.birthday(b.get("birthday"))}),this.credit_card_fields={show_success:ko.observable(!1).extend({resetAfter:5e3}),number:ko.observable(),expiration_month:ko.observable(),expiration_year:ko.observable(),cvc:ko.observable()},_.extend(this.credit_card_fields,{formatted_number:ko.computed({read:function(){var b,c,d,e,f;return d=Q(a.credit_card_fields.number),d!=null&&(d=d.toString()),_.isString(d)||(d=""),b=d.slice(0,4),e=d.slice(4,8),f=d.slice(8,12),c=d.slice(12,16),_.isEmpty(e)||(b+="-"),_.isEmpty(f)||(e+="-"),_.isEmpty(c)||(f+="-"),b+e+f+c},write:function(b){return a.credit_card_fields.number(""),b==null&&(b=""),b=b.toString(),b=b.replace(/[^0-9]/gi,"").slice(0,16),a.credit_card_fields.number(b)}}),formatted_expiration:ko.computed({read:function(){var b,c,d,e;return b=_.trim((d=Q(a.credit_card_fields["expiration_month"]))!=null?d:""),c=_.trim((e=Q(a.credit_card_fields["expiration_year"]))!=null?e:""),b.length>0&&c.length>0?""+b+"/"+c:""},write:function(b){var c,d,e;return a.credit_card_fields.expiration_month(""),a.credit_card_fields.expiration_year(""),b=b!=null?b.toString():"",b=_.trim(b).replace(/[^0123456789\/]/gi,""),e=b.split("/",2),c=e[0],d=e[1],d==null&&(d=""),d=d.replace(/[^0-9]/gi,""),c=c.slice(0,2),d=d.slice(0,4),c=parseInt(c,10),d=parseInt(d,10),c>12&&(c=12),c<1&&(c=1),d<2e3&&(d+=2e3),d<(new Date).getFullYear()&&(d=(new Date).getFullYear()),c=_.isNaN(c)?"":c.toString(),d=_.isNaN(d)?"":d.toString(),c.length===1&&(c="0"+c),a.credit_card_fields.expiration_month(c),a.credit_card_fields.expiration_year(d)}}),formatted_cvc:ko.computed({read:function(){return Q(a.credit_card_fields.cvc)},write:function(b){return a.credit_card_fields.cvc(""),b=b!=null?b.toString():"",b=b.replace(/[^0-9]/gi,"").slice(0,3),a.credit_card_fields.cvc(b)}})}),this.credit_card_fields.formatted_number.classify("errorable"),this.credit_card_fields.formatted_expiration.classify("errorable"),this.credit_card_fields.formatted_cvc.classify("errorable")},b.prototype._resetFlags=function(){return this.showing_profile(!1),this.showing_credit_card(!1),this.showing_password(!1),this.showing_picture(!1),this.showing_connect(!1)},b.prototype.showProfile=function(){return this._resetFlags(),this.showing_profile(!0)},b.prototype.showCreditCard=function(){return this._resetFlags(),this.showing_credit_card(!0)},b.prototype.showPassword=function(){return this._resetFlags(),this.showing_password(!0)},b.prototype.showConnect=function(){return this._resetFlags(),this.showing_connect(!0)},b.prototype.showPicture=function(){return this._resetFlags(),this.showing_picture(!0)},b.prototype.saveProfile=function(){var a,b,c,d,e,f,g=this;f=Q(N);if(f instanceof H){this.profile_fields.name.clear_error(),this.profile_fields.email.clear_error(),this.profile_fields.birthday.clear_error(),d=Q(this.profile_fields.name),b=Q(this.profile_fields.email),a=Q(this.profile_fields.birthday),c=!1,d==null&&(this.profile_fields.name.error("Please enter a name."),c=!0),b==null&&(this.profile_fields.email.error("Please enter an email."),c=!0);if(c)return;_.isEmpty(d)&&(this.profile_fields.name.error("Please enter a name."),c=!0),_.isEmpty(b)&&(this.profile_fields.email.error("Please enter an email."),c=!0);if(c)return;Helpers.isEmail(b)||(this.profile_fields.email.error("Please enter a valid email."),c=!0);if(c)return;return this.saving_settings(!0),e=f.clone(),e.set("name",d),e.set("email",b),e.set("birthday",a),e.save({fields:["name","email","birthday"],complete:function(){return g.saving_settings(!1)},success:function(){return f.fill(e.serialize()),g.profile_fields.show_success(!0)},error:function(){}})}return},b.prototype.saveCreditCard=function(){var a,b,c,d,e,f,g=this;f=Q(N);if(f instanceof H){this.credit_card_fields.formatted_number.clear_error(),this.credit_card_fields.formatted_expiration.clear_error(),this.credit_card_fields.formatted_cvc.clear_error(),e=Q(this.credit_card_fields.number),b=Q(this.credit_card_fields.expiration_month),c=Q(this.credit_card_fields.expiration_year),a=Q(this.credit_card_fields.cvc),d=!1,e==null&&(this.credit_card_fields.formatted_number.error("Please enter a valid card number."),d=!0);if(b==null||c==null)this.credit_card_fields.formatted_expiration.error("Please enter a valid expiration date!"),d=!0;a==null&&(this.credit_card_fields.formatted_cvc.error("Please enter a valid CVC code."),d=!0);if(d)return;Stripe.validateCardNumber(e)||(this.credit_card_fields.formatted_number.error("Please enter a valid card number."),d=!0),Stripe.validateExpiry(b,c)||(this.credit_card_fields.formatted_expiration.error("Please enter a valid expiration date."),d=!0),Stripe.validateCVC(a)||(this.credit_card_fields.formatted_cvc.error("Please enter a valid CVC code."),d=!0);if(d)return;return this.saving_settings(!0),Stripe.createToken({number:e,cvc:a,exp_month:b,exp_year:c},function(a,b){var c;return b.error?(g.credit_card_fields.message.error("An error occurred validating your credit card"),g.saving_settings(!1)):(c=f.clone(),c.set("stripe_token",b.id),c.save({fields:["stripe_token"],complete:function(){return g.saving_settings(!1)},success:function(){return console.log(c.serialize()),f.fill(c.serialize()),g.credit_card_fields.formatted_number(""),g.credit_card_fields.formatted_expiration(""),g.credit_card_fields.formatted_cvc(""),g.credit_card_fields.show_success(!0)},error:function(){}}))})}return},b}(Falcon.View),E=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="statistics.tmpl",b.prototype.initialize=function(){var a=this;return this.users=ko.computed(function(){var a;return a=Q(N),a instanceof H?[a].concat(a.get("relations").list()):[]}),this.selected_user=ko.observable(this.users()[0]),this.selected_event=ko.observable(),this.selected_session=ko.observable(),this.dropdown_is_open=ko.observable(!1),this.session_dropdown_is_open=ko.observable(!1),this.events=new r,this.page_loading=ko.observable(!0),this._fetchEvents(function(){return a.page_loading(!1)})},b.prototype.filtered_events=function(){var a,b,c;return c=Q(this.selected_user),c==null?[]:(b=[],a=[],this.events.each(function(c,d){return d%3===0&&b.push(a=[]),a.push(c)}),b)},b.prototype._fetchEvents=function(a){var b;return _.isFunction(a)||(a=function(){}),b={f:"registered",r:5e3,page_size:30},this.events.fetch({fields:_.keys(b),params:b,complete:a})},b.prototype.isSelectedUser=function(a){var b;return b=Q(this.selected_user),b==null?!1:b===a},b.prototype.selectUser=function(a){return this.selected_user(a),this.dropdown_is_open(!1)},b.prototype.selectEvent=function(a){return this.selected_event(a),this.selected_session(a.sessions.first()),this.session_dropdown_is_open(!1),$("input.stat").val(0)},b.prototype.isSelectedEvent=function(a){var b;return b=Q(this.selected_event),b==null?!1:b===a},b.prototype.selectSession=function(a){return this.selected_session(a),this.session_dropdown_is_open(!1),$("input.stat").val(0)},b.prototype.isSelectedSession=function(a){var b;return b=Q(this.selected_session),b==null?!1:b===a},b.prototype.toggleSessionDropdown=function(){return this.session_dropdown_is_open(!this.session_dropdown_is_open())},b.prototype.toggleDropdownOpen=function(){return this.dropdown_is_open(!this.dropdown_is_open())},b.prototype.saveStats=function(){return this.selected_event(null)},b}(Falcon.View),F=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="stream.tmpl",b.prototype.initialize=function(){var a,b=this;return this.showing_nearby_events=ko.observable(!1),this.showing_registered_events=ko.observable(!1),this.showing_invited_events=ko.observable(!1),this.showing_league_events=ko.observable(!1),this.showing_large_cover=ko.observable(!1),this.loading_events=ko.observable(!1),this.invited_count=ko.observable(0),this._current_events_request=null,this.address_search=ko.observable(),this.events=new r,this.lat=ko.computed({read:function(){return Q(L.location.lat)},write:function(a){if(ko.isWriteableObservable(L.location.lat))return L.location.lat(a)}}),this.lng=ko.computed({read:function(){return Q(L.location.lng)},write:function(a){if(ko.isWriteableObservable(L.location.lng))return L.location.lng(a)}}),ko.computed(function(){return Q(b.lat),Q(b.lng),_.defer(function(){return b._fetchEvents()})}).extend({throttle:50}),a={f:"invited",r:5e3,per:100},(new r).fetch({fields:_.keys(a),params:a,complete:function(a){return b.invited_count(a.length())}})},b.prototype.filtered_events=function(){return this.events},b.prototype._resetFlags=function(){return this.showing_nearby_events(!1),this.showing_registered_events(!1),this.showing_invited_events(!1),this.showing_league_events(!1)},b.prototype._fetchEvents=function(){var a,b,c=this;this.loading_events(!0);if(Q(L.location.loading)){b=L.location.loading.subscribe(function(d){if(d===!1)return c._fetchEvents(a),b.dispose()});return}return a={},this.showing_registered_events()?a={f:"registered",r:5e3,page_size:30}:this.showing_invited_events()?a={f:"invited",r:5e3,page_size:30}:a={f:"nearby",r:200,lat:Q(this.lat),lng:Q(this.lng),page_size:30},this.events.fetch({fields:_.keys(a),params:a,complete:function(){return c.showing_invited_events()&&c.invited_count(c.events.length()),c.loading_events(!1)}})},b.prototype.showNearbyEvents=function(){return this._resetFlags(),this.showing_nearby_events(!0),this._fetchEvents()},b.prototype.showRegisteredEvents=function(){return this._resetFlags(),this.showing_registered_events(!0),this._fetchEvents()},b.prototype.showInvitedEvents=function(){return this._resetFlags(),this.showing_invited_events(!0),this._fetchEvents()},b.prototype.showLeagueEvents=function(){return this._resetFlags(),this.showing_league_events(!0)},b.prototype.toggleLargeCover=function(){return this.showing_large_cover(!this.showing_large_cover()),setTimeout(function(){return Helpers.resizeMaps()},250)},b.prototype.gotoEvent=function(a){var b;if(a instanceof j){b=a.get("id");if(b==null)return;return Finch.navigate("event/"+b)}return},b.prototype.doAddressSearch=function(){var a,b=this;if(typeof google!="undefined"&&google!==null&&google.maps!=null){a=new google.maps.Geocoder;if(a!=null)return a.geocode({address:this.address_search()},function(a){var c;a=_.first(a);if(a!=null)return c=a.geometry.location,b.lat(c.Xa),b.lng(c.Ya)})}},b}(Falcon.View),D=function(a){function b(){b.__super__.constructor.apply(this,arguments)}return W(b,a),b.prototype.url="/splash.tmpl",b.prototype.initialize=function(){var a=this;return this.login_fields={username:ko.observable().classify("errorable"),password:ko.observable().classify("errorable")},this.register_fields={name:ko.observable().classify("errorable"),email:ko.observable().classify("errorable"),birthday:ko.observable().classify("date","errorable"),username:ko.observable().classify("errorable"),password:ko.observable().classify("errorable"),retype:ko.observable().classify("errorable")},this.showingLogin=ko.observable(!1),this.showingRegister=ko.observable(!1),this.showingIntro=ko.computed(function(){return!a.showingRegister()&&!a.showingLogin()}),this.doing_login=ko.observable(!1),this.doing_register=ko.observable(!1),this.login_error=ko.observable().extend({errorable:!0}),this.register_error=ko.observable().extend({errorable:!0})},b.prototype.doFacebookRequest=function(a){var b,c=this;return b=null,a==="login"&&this.login_error.clear_error(),a==="login"&&this.register_error.clear_error(),a==="login"&&this.doing_login(!0),a==="register"&&this.doing_register(!0),O.facebookLogin({facebook_success:function(a){return b=a.authResponse.accessToken},facebook_error:function(){a==="login"&&c.login_error.error("Could not login with facebook"),a==="register"&&c.register_error.error("Could not register with facebook"),a==="login"&&c.doing_login(!1);if(a==="register")return c.doing_register(!1)},success:function(){a==="login"&&c.doing_login(!1);if(a==="register")return c.doing_register(!1)},error:function(){if(!_.isString(b)){a==="login"&&c.doing_login(!1),a==="register"&&c.doing_register(!1);return}return(new H({facebook_access_token:b})).create({fields:["facebook_access_token"],error:function(){a==="login"&&c.login_error.error("Could not register user's facebook for login"),a==="register"&&c.register_error.error("Could not register user's facebook"),a==="login"&&c.doing_login(!1);if(a==="register")return c.doing_register(!1)},success:function(){return O.facebook_access_token(b),O._attemptLogin(["facebook_access_token"],{complete:function(){a==="login"&&c.doing_login(!1);if(a==="register")return c.doing_register(!1)}})}})}})},b.prototype.doFacebookLogin=function(){return this.doFacebookRequest("login")},b.prototype.doFacebookRegister=function(){return this.doFacebookRequest("register")},b.prototype.doLogin=function(){var a,b,c,d,e,f=this;c=(d=Q(this.login_fields.username))!=null?d:"",b=(e=Q(this.login_fields.password))!=null?e:"",a=!1,this.login_fields.username.clear_error(),this.login_fields.password.clear_error(),this.login_error.clear_error(),_.isString(c)||(this.login_fields.username.error("Username must be a string value."),a=!0),_.isString(b)||(this.login_fields.password.error("Password must be a string value."),a=!0);if(a)return;c=_.trim(c),b=_.trim(b),c.length===0&&(this.login_fields.username.error("Please enter a username."),a=!0),b.length===0&&(this.login_fields.password.error("Please enter a password."),a=!0);if(a)return;return this.doing_login(!0),O.login(c,b,{error:function(a,b){return _.isObject(b)?f.login_error.error(b.error):f.login_error.error("An error occurred, please try again.")},complete:function(){return f.doing_login(!1),f.doing_register(!1)}})},b.prototype.doRegister=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o=this;d=(i=Q(this.register_fields.name))!=null?i:"",b=(j=Q(this.register_fields.email))!=null?j:"",a=(k=Q(this.register_fields.birthday))!=null?k:"",h=(l=Q(this.register_fields.username))!=null?l:"",e=(m=Q(this.register_fields.password))!=null?m:"",f=(n=Q(this.register_fields.retype))!=null?n:"",c=!1,this.register_fields.name.clear_error(),this.register_fields.email.clear_error(),this.register_fields.birthday.clear_error(),this.register_fields.username.clear_error(),this.register_fields.password.clear_error(),this.register_fields.retype.clear_error(),_.isString(d)||(this.register_fields.name.error("Name must be a string value"),c=!0),_.isString(b)||(this.register_fields.email.error("Email must be a string value"),c=!0),_.isString(a)||(this.register_fields.birthday.error("Birthday must be a string value"),c=!0),_.isString(h)||(this.register_fields.username.error("Username must be a string value"),c=!0),_.isString(e)||(this.register_fields.password.error("Password must be a string value"),c=!0),_.isString(f)||(this.register_fields.retype.error("Retype must be a string value"),c=!0);if(c)return;d=_.trim(d),b=_.trim(b),a=_.trim(a),h=_.trim(h),e=_.trim(e),f=_.trim(f),d.length===0&&(this.register_fields.name.error("Please enter your name"),c=!0),b.length===0&&(this.register_fields.email.error("Please enter an email"),c=!0),a.length===0&&(this.register_fields.birthday.error("Please enter an birthday"),c=!0),h.length===0&&(this.register_fields.username.error("Please enter a username"),c=!0),e.length===0&&(this.register_fields.password.error("Please enter your password"),c=!0),f.length===0&&(this.register_fields.retype.error("Please retype your password"),c=!0);if(c)return;e!==f&&(this.register_fields.retype.error("Passwords do not match"),c=!0);if(c)return;Helpers.isEmail(b)||(this.register_fields.email.error("Please enter a valid email address"),c=!0);if(c)return;return this.register_error.clear_error(),this.doing_register(!0),g=new H,g.set("name",d),g.set("email",b),g.set("birthday",a),g.set("username",h),g.set("password",e),g.create({fields:["name","username","birthday","email","password"],success:function(){return o.register_error.clear_error(),o.login_fields.username(h),o.login_fields.password(e),o.doLogin()},error:function(a,b){return _.isObject(b)?o.login_error.error(b.error):o.login_error.error("An error occurred, please try again."),o.doing_register(!1)}})},b.prototype.showIntro=function(){return this.showingLogin(!1),this.showingRegister(!1)},b.prototype.showLogin=function(){return this.showingLogin(!0),this.showingRegister(!1)},b.prototype.showRegister=function(){return this.showingLogin(!1),this.showingRegister(!0)},b}(Falcon.View),d=ko.observable(),e=$(window),b=$(document),a=$("body"),c=$("html"),this.session=O=new B(function(){return O.user()==null&&Finch.navigate("/"),Finch.listen()}),this.me=N=O.user,L={},L.facebookStatus="",L.facebookAccessToken="",L.facebookLogin=function(a){if(typeof FB=="undefined"||FB===null)return;return L.facebookStatus==="connected"?FB.getLoginStatus(a,!0):FB.login(a,{scope:"email,user_about_me,user_birthday,user_hometown,user_location,friends_location,user_status,friends_status,publish_checkins,publish_stream,publish_actions"})},M=function(a){var b,c,d;return d=function(){FB.init({appId:ENV.FACEBOOK_APP_ID,channelUrl:ENV.DOMAIN+"/facebook_channel.html",status:!0,cookie:!0,xfbml:!0}),FB.Event.subscribe("auth.statusChange",function(a){return L.facebookStatus=a.status,L.facebookAccessToken=a.status==="connected"?a.authResponse.accessToken:""});if(_.isFunction(a))return a()},b=document.getElementsByTagName("head")[0],c=document.createElement("script"),c.type="text/javascript",c.src="//connect.facebook.net/en_US/all.js",c.onload=d,c.onreadystatechange=function(){if(this.readyState==="complete")return d()},b.appendChild(c),M=function(){}},e.on("error",function(a){var b,c;c=a.originalEvent,b="PAGE: "+window.location.href+" ";try{c.lineno!=null&&(b+=" | LINE: "+c.lineno)}catch(d){}try{c.filename!=null&&(b+=" | FILENAME: "+c.filename)}catch(d){}try{c.message!=null&&(b+=" | MESSAGE: "+c.message)}catch(d){}try{N()instanceof H&&(b+=" | USER: "+Q(N().id)+" - "+Q(N().name)+" <"+Q(N().email)+">")}catch(d){}return _gaq.push(["_trackEvent","Error","Javascript Error",b]),console.log("TRACKED",["Error","Javascript Error",b])}),$.browser.msie&&parseInt($.browser.version)===7?(J=window.location.href,setInterval(function(){if(J!==window.location.href)return _gaq.push(["_trackPageview"]),J=window.location.href},200)):e.on("hashchange",function(){return _gaq.push(["_trackPageview",window.location.hash])}),typeof google!="undefined"&&google!==null&&google.load("visualization","1",{packages:["corechart"]}),L.location={loading:null,geocoder:null,lat:null,lng:null,city:null,county:null,state:null,street:null,address:null,country:null,postal_code:null},navigator.geolocation!=null&&(L.location.loading=ko.observable(!0),L.location.lat=ko.observable(),L.location.lng=ko.observable(),typeof google!="undefined"&&google!==null&&google.maps!=null&&(K=new google.maps.Geocoder,L.location.city=ko.observable(),L.location.county=ko.observable(),L.location.state=ko.observable(),L.location.street=ko.observable(),L.location.address=ko.observable(),L.location.country=ko.observable(),L.location.postal_code=ko.observable()),R=function(){return L.location.loading(!1)},U=function(a){var b;return K!=null?(b=new google.maps.LatLng(a.coords.latitude,a.coords.longitude),K.geocode({latLng:b},function(b,c){var d,e,f,g,h,i,j;if(c===google.maps.GeocoderStatus.OK){L.location.lat(a.coords.latitude),L.location.lng(a.coords.longitude);if((e=b[0])!=null){f="",j=e.address_components;for(h=0,i=j.length;h<i;h++)d=j[h],g=d.types,g[0]==="street_number"&&(f=d.long_name+f),g[0]==="route"&&(f+=" "+d.long_name),g[0]==="locality"&&L.location.city(d.short_name),g[0]==="administrative_area_level_2"&&L.location.county(d.short_name),g[0]==="administrative_area_level_1"&&L.location.state(d.short_name),g[0]==="country"&&L.location.country(d.short_name),g[0]==="postal_code"&&L.location.postal_code(d.short_name);L.location.street(f),L.location.address(e.formatted_address)}}return R()})):(L.location.lat(a.coords.latitude),L.location.lng(a.coords.longitude),R())},S=function(a){var b;return b="CODE: "+a.code+" | MESSAGE: "+a.message,_gaq.push(["_trackEvent","Error","Location Error",b]),console.log("TRACKED",["Error","Location Error",b]),R()},T={timeout:5e3,maximumAge:0,enableHighAccuracy:!0},navigator.geolocation.getCurrentPosition(U,S,T)),c.addClass("loading"),Falcon.apply(d,"#application",function(){return _.defer(function(){var a;return a=_.times(1,function(){return _.delay(function(){return c.removeClass("loading")},100)}),M(a)})})})).call(this)